<div i18n="@@book.list.createNew" class="btn btn-sm btn-primary" (click)="toggleCreateBook = !toggleCreateBook">Create new</div>

@if (toggleCreateBook) {
  <h1 class="flex-grow-1" i18n="@@book.add.headline">Add Book</h1>
  <div class="row">
    <div class="col-12 col-md-6">
      <form (ngSubmit)="handleSearchBook()">
        <div class="row">
          <div class="form-group col-10">
            <input id="bookTitle" [(ngModel)]="isbnSearch" name="Isbn" class="form-control" type="text" i18n-placeholder="@@book.placeholder" placeholder="Enter book isbn" required />
          </div>

          <button type="submit" class="btn btn-primary col-2" [disabled]="loading || !isbnSearch.trim()">
            {{ loading ? 'Searching...' : 'Search' }}
          </button>
        </div>
      </form>
    </div>
    <div class="col-12 col-md-6">
      <div class="card" *ngIf="bookSearchResult">
        <div class="card-body">
          <h5 class="card-title" i18n="@@book.search.title">{{ bookSearchResult.title }}</h5>
          <p class="card-text" i18n="@@book.search.isbn_13">Isbn 13: <b>{{bookSearchResult.isbn_13.join(', ')}}</b></p>
          <p class="card-text" i18n="@@book.search.revision">Revision: <b>{{bookSearchResult.revision}}</b></p>
        </div>
        <ul class="list-group list-group-flush" *ngFor="let publisher of bookSearchResult.publishers">
          <li class="list-group-item" i18n="@@book.search.publisher">{{publisher}}</li>
        </ul>
        <div class="card-footer">
          <button class="btn btn-primary" i18n="@@book.add.label" (click)="handleSubmit()">Add to catalog</button>
        </div>
      </div>
    </div>
  </div>
}

@if (books && books.length === 0) {
  <div i18n="@@book.list.empty">No Books could be found.</div>
} @else {
  <div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
      <thead>
        <tr>
          <th scope="col" i18n="@@book.id.label">Id</th>
          <th scope="col" i18n="@@book.title.label">Title</th>
          <th scope="col" i18n="@@book.isbn.label">Isbn</th>
          <th><!----></th>
        </tr>
      </thead>
      <tbody>
        @for (book of books; track book.id) {
          <tr>
            <td>{{book.id}}</td>
            <td>{{book.title}}</td>
            <td>{{book.isbn}}</td>
            <td>
              <div class="float-end text-nowrap">
                <a [routerLink]="['/books/edit', book.id]" class="btn btn-sm btn-secondary" i18n="@@book.list.edit">Edit</a>
                <button type="button" (click)="confirmDelete(book.id!)" class="btn btn-sm btn-secondary ms-2" i18n="@@book.list.delete">Delete</button>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </table>

    <nav aria-label="Page navigation example" *ngIf="paginationUtils">
      <ul class="pagination">
        <li class="page-item" [class.disabled]="paginationUtils!.number === 0">
          <button class="page-link" (click)="onPageChange(paginationUtils!.number - 1)">Previous</button>
        </li>
        <li class="page-item" *ngFor="let page of getPageRange()" [class.active]="page === paginationUtils!.number">
          <button class="page-link" (click)="onPageChange(page)">{{ page + 1 }}</button>
        </li>
        <li class="page-item" [class.disabled]="paginationUtils!.number === paginationUtils!.totalPages - 1">
          <button class="page-link" (click)="onPageChange(paginationUtils!.number + 1)">Next</button>
        </li>
      </ul>
    </nav>

  </div>
}
